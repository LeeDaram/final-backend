<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.example.finalEclips.eclips.bizconfig.repository.BizImgConfigMapper">

	<!-- 착한가격업소 테이블 생성 -->
	<insert id="saveGpb"
		parameterType="com.example.finalEclips.eclips.bizconfig.dto.CreateGpbDto">
		<selectKey keyProperty="storeId" resultType="int"
			order="BEFORE">
			SELECT good_price_seq.NEXTVAL FROM DUAL
		</selectKey>
		INSERT INTO GOOD_PRICE_BUSINESS
		(STORE_ID, USER_ID, INDUSTRY_ID,
		CONTACT, STORE_IMAGE, AVERAGE_RATING, TAKEOUT,
		DELIVERY, WIFI, PET,
		KID, PARKING)
		VALUES
		(#{storeId},#{userId}, #{industryId},
		#{contact,
		jdbcType=VARCHAR},
		#{storeImage, jdbcType=VARCHAR},
		0,
		#{takeout},
		#{delivery},
		#{wifi},
		#{pet},
		#{kid},
		#{parking})
	</insert>
	<!-- 승인테이블 생성 -->
	<insert id="saveApproval">
		INSERT INTO APPROVAL_MANAGEMENT
		(STORE_ID, MAIN_MENU,
		PRICE, PRICE_APPROVAL, CLEANLINESS_APPROVAL,
		FINAL_APPROVAL_STATUS)
		VALUES(#{storeId}, #{mainMenu}, #{price},
		#{priceApproval},
		#{cleanlinessApproval},
		#{finalApprovalStatus})
	</insert>

	<!-- 파일업로드 -->
	<insert id="saveBizImgAttachments">
		INSERT INTO APPROVAL_MANAGEMENT_ATTACHMENTS
		(STORE_ID, ORIGIN_FILENAME,
		STORED_FILENAME, CONTENT_TYPE, FILE_SIZE)
		VALUES
		<foreach collection="fileDtos" item="item" separator=",">
			(#{storeId}, #{item.originFilename}, #{item.storedFilename},
			#{item.contentType}, #{item.size})
		</foreach>
	</insert>
	
	<!-- 예약 T,F -->
	<insert id="saveIsActivate">
		INSERT INTO ACTIVATE_RESERVATION
		(store_id,
		IS_ACTIVATE)
		VALUES(#{storeId}, #{isActivate})
	</insert>




</mapper>